---
import Git from "@/icons/git.astro";
import Arrow from "@/icons/Arrow.astro";
import Section from "../Section.astro";

import { projects } from "@cv";
---

<Section className={Astro.props.className} title="Projects">
  <div class="grid grid-cols-1 gap-3 md:grid-cols-2 print:flex print:flex-col">
    {
      projects.map(
        ({ url, description, highlights, name, isActive, github }) => {
          return (
            <div
              role="contentinfo"
              class="project-card relative grid-span-1 group flex flex-col overflow-hidden rounded-2xl bg-skin-button-muted/40 p-5 ring-1 ring-skin-muted/60 shadow-sm transition-all duration-300 ease-out hover:-translate-y-1 hover:bg-skin-button-muted/60 hover:shadow-lg hover:ring-skin-hue/40 print:shadow-none print:ring-skin-muted/50"
            >
              <span class="deco" aria-hidden="true"></span>
               <div class="flex items-center justify-between space-x-[10px]">
                 <div class="flex items-center gap-2">
                   <svg
                     xmlns="http://www.w3.org/2000/svg"
                     width="24"
                     height="24"
                     viewBox="0 0 24 24"
                     fill="none"
                     stroke="currentColor"
                     stroke-width="2"
                     stroke-linecap="round"
                     stroke-linejoin="round"
                     class="lucide lucide-folder size-4"
                   >
                     <path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z" />
                   </svg>
                   <div class="flex items-center gap-[6px]">
                     {isActive ? (
                       <a
                         class="group/link flex items-center gap-[6px] text-lg decoration-dotted underline-offset-[5px] hover:text-skin-hue hover:underline"
                         href={url}
                         title={`Ver ${name}`}
                         target="_blank"
                       >
                         {name}
                        <span class="live-badge">Live</span>
                         <span class="text-skin-hue transition ease-linear group-hover:-translate-y-0.5 group-hover:translate-x-0.5">
                           <Arrow />
                         </span>
                       </a>
                     ) : (
                       <span>{name}</span>
                     )}
                   </div>
                 </div>
 
                 {github && (
                   <a
                     href={github}
                     title="View slug repository on GitHub"
                     target="_blank"
                     rel="noopener"
                    class="opacity-80 transition-all duration-200 hover:opacity-100 hover:text-skin-hue"
                   >
                     <Git />
                   </a>
                 )}
               </div>
 
               <p class="py-3 text-sm text-skin-base">{description}</p>
               <ul class="mt-1 text-sm text-skin-muted">
                 {highlights.map((highlight) => {
                   return <li>{highlight}</li>;
                 })}
               </ul>
             </div>
          );
        },
      )
    }
  </div>
</Section>

<style>
  ul {
    @apply ml-4 list-disc space-y-1;
    li {
      @apply text-skin-muted;
    }
  }

  /* Modern, theme-aware card decoration */
  .project-card::after {
    content: "";
    position: absolute;
    inset-inline: 0;
    top: 0;
    height: 3px;
    background: rgb(var(--color));
    opacity: 0.25;
    transition: opacity .3s ease;
  }
  .project-card:hover::after {
    opacity: 0.8;
  }
  .project-card .deco {
    position: absolute;
    inset: auto auto -30% -20%;
    width: 220px;
    height: 220px;
    border-radius: 9999px;
    background: radial-gradient(120px 120px at 60% 40%, rgba(var(--color), .15), transparent 60%);
    filter: blur(30px);
    opacity: .5;
    transition: transform .3s ease, opacity .3s ease;
    pointer-events: none;
  }
  .project-card:hover .deco {
    transform: translate(4px, -4px) scale(1.02);
    opacity: .7;
  }
  .live-badge {
    @apply text-xs;
    margin-left: .25rem;
    padding: 2px 6px;
    border-radius: 9999px;
    background: rgba(var(--color), .12);
    color: rgb(var(--color));
    border: 1px solid rgba(var(--color), .25);
  }

  footer {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    font-size: 0.6rem;
  }

  footer span {
    border-radius: 6px;
    background: #eee;
    color: #444;
    font-size: 0.6rem;
    font-weight: 500;
    padding: 0.2rem 0.6rem;
  }
  @keyframes flicker {
    0% {
      opacity: 1;
    }
    50% {
      opacity: 0.25;
    }
    100% {
      opacity: 1;
    }
  }
</style>